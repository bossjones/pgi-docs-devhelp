

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>
    GLib.MarkupParseContext -
    
      Structures -
    
    GLib 2.0
  </title>
  

  
  

  

  
  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  <link rel="stylesheet" href="../_static/css/pgi.css" type="text/css" />
    <link rel="top" title="GLib 2.0 Python API Docs" href="../index.html"/>
        <link rel="up" title="Structures" href="index.html"/>
        <link rel="next" title="GLib.MarkupParser" href="MarkupParser.html"/>
        <link rel="prev" title="GLib.MappedFile" href="MappedFile.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

<div class="non-fixed-bar">
<table class="navigation" summary="Navigation header" cellpadding="2" cellspacing="10" width="100%"><tbody><tr valign="middle">

<td class="shortcuts" align="left" width="100%">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">GLib 2.0</a> &raquo;</li>
      
          <li><a href="index.html">Structures</a> &raquo;</li>
      
    <li>GLib.MarkupParseContext</li>
  </ul>
</td>
<td><a accesskey="h" href="../index.html"><i class="fa fa-home"></i></a></td>


<td><a accesskey="u" href="index.html"><i class="fa fa-chevron-up"></i></a></td>



<td><a accesskey="p" href="MappedFile.html"><i class="fa fa-chevron-left"></i></a></td>



<td><a accesskey="n" href="MarkupParser.html"><i class="fa fa-chevron-right"></i></a></td>


</tr></tbody>
</table>

<div class="local-toc">
    <ul>
<li><a class="reference internal" href="#">GLib.MarkupParseContext</a><ul>
<li><a class="reference internal" href="#fields">Fields</a></li>
<li><a class="reference internal" href="#methods">Methods</a></li>
<li><a class="reference internal" href="#details">Details</a></li>
</ul>
</li>
</ul>

</div>
</div>

<div class="fixed-bar">
  <table class="navigation" summary="Navigation header" cellpadding="2" cellspacing="10" width="100%"><tbody><tr valign="middle">

<td class="shortcuts" align="left" width="100%">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">GLib 2.0</a> &raquo;</li>
      
          <li><a href="index.html">Structures</a> &raquo;</li>
      
    <li>GLib.MarkupParseContext</li>
  </ul>
</td>
<td><a accesskey="h" href="../index.html"><i class="fa fa-home"></i></a></td>


<td><a accesskey="u" href="index.html"><i class="fa fa-chevron-up"></i></a></td>



<td><a accesskey="p" href="MappedFile.html"><i class="fa fa-chevron-left"></i></a></td>



<td><a accesskey="n" href="MarkupParser.html"><i class="fa fa-chevron-right"></i></a></td>


</tr></tbody>
</table>

<div class="local-toc">
    <ul>
<li><a class="reference internal" href="#">GLib.MarkupParseContext</a><ul>
<li><a class="reference internal" href="#fields">Fields</a></li>
<li><a class="reference internal" href="#methods">Methods</a></li>
<li><a class="reference internal" href="#details">Details</a></li>
</ul>
</li>
</ul>

</div>
</div>

  <div class="wy-grid-for-nav">

    

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="main">
            
  <div class="section" id="glib-markupparsecontext">
<h1>GLib.MarkupParseContext</h1>
<div class="section" id="fields">
<span id="glib-markupparsecontext-fields"></span><h2>Fields</h2>
<p>None</p>
</div>
<div class="section" id="methods">
<h2>Methods</h2>
<table border="1" class="longtable docutils">
<colgroup>
<col width="0%" />
<col width="100%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><em>static</em></td>
<td><a class="reference internal" href="#GLib.MarkupParseContext.new" title="GLib.MarkupParseContext.new"><tt class="xref py py-obj docutils literal"><span class="pre">new</span></tt></a>(parser, flags, user_data, user_data_dnotify)</td>
</tr>
<tr class="row-even"><td></td>
<td><a class="reference internal" href="#GLib.MarkupParseContext.end_parse" title="GLib.MarkupParseContext.end_parse"><tt class="xref py py-obj docutils literal"><span class="pre">end_parse</span></tt></a>()</td>
</tr>
<tr class="row-odd"><td></td>
<td><a class="reference internal" href="#GLib.MarkupParseContext.free" title="GLib.MarkupParseContext.free"><tt class="xref py py-obj docutils literal"><span class="pre">free</span></tt></a>()</td>
</tr>
<tr class="row-even"><td></td>
<td><a class="reference internal" href="#GLib.MarkupParseContext.get_element" title="GLib.MarkupParseContext.get_element"><tt class="xref py py-obj docutils literal"><span class="pre">get_element</span></tt></a>()</td>
</tr>
<tr class="row-odd"><td></td>
<td><a class="reference internal" href="#GLib.MarkupParseContext.get_position" title="GLib.MarkupParseContext.get_position"><tt class="xref py py-obj docutils literal"><span class="pre">get_position</span></tt></a>(line_number, char_number)</td>
</tr>
<tr class="row-even"><td></td>
<td><a class="reference internal" href="#GLib.MarkupParseContext.parse" title="GLib.MarkupParseContext.parse"><tt class="xref py py-obj docutils literal"><span class="pre">parse</span></tt></a>(text, text_len)</td>
</tr>
<tr class="row-odd"><td></td>
<td><a class="reference internal" href="#GLib.MarkupParseContext.push" title="GLib.MarkupParseContext.push"><tt class="xref py py-obj docutils literal"><span class="pre">push</span></tt></a>(parser, user_data)</td>
</tr>
<tr class="row-even"><td></td>
<td><a class="reference internal" href="#GLib.MarkupParseContext.ref" title="GLib.MarkupParseContext.ref"><tt class="xref py py-obj docutils literal"><span class="pre">ref</span></tt></a>()</td>
</tr>
<tr class="row-odd"><td></td>
<td><a class="reference internal" href="#GLib.MarkupParseContext.unref" title="GLib.MarkupParseContext.unref"><tt class="xref py py-obj docutils literal"><span class="pre">unref</span></tt></a>()</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="details">
<h2>Details</h2>
<dl class="class">
<dt id="GLib.MarkupParseContext">
<em class="property">class </em><tt class="descclassname">GLib.</tt><tt class="descname">MarkupParseContext</tt></dt>
<dd><p>A parse context is used to parse a stream of bytes that
you expect to contain marked-up text.</p>
<p>See <a class="reference internal" href="#GLib.MarkupParseContext.new" title="GLib.MarkupParseContext.new"><tt class="xref py py-obj docutils literal"><span class="pre">GLib.MarkupParseContext.new</span></tt></a> (), <a class="reference internal" href="MarkupParser.html#GLib.MarkupParser" title="GLib.MarkupParser"><tt class="xref py py-obj docutils literal"><span class="pre">GLib.MarkupParser</span></tt></a>, and so
on for more details.</p>
<dl class="staticmethod">
<dt id="GLib.MarkupParseContext.new">
<em class="property">static </em><tt class="descname">new</tt><big>(</big><em>parser</em>, <em>flags</em>, <em>user_data</em>, <em>user_data_dnotify</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>parser</strong> (<a class="reference internal" href="MarkupParser.html#GLib.MarkupParser" title="GLib.MarkupParser"><tt class="xref py py-class docutils literal"><span class="pre">GLib.MarkupParser</span></tt></a>) &#8211; a <a class="reference internal" href="MarkupParser.html#GLib.MarkupParser" title="GLib.MarkupParser"><tt class="xref py py-obj docutils literal"><span class="pre">GLib.MarkupParser</span></tt></a></li>
<li><strong>flags</strong> (<a class="reference internal" href="../flags.html#GLib.MarkupParseFlags" title="GLib.MarkupParseFlags"><tt class="xref py py-class docutils literal"><span class="pre">GLib.MarkupParseFlags</span></tt></a>) &#8211; one or more <a class="reference internal" href="../flags.html#GLib.MarkupParseFlags" title="GLib.MarkupParseFlags"><tt class="xref py py-obj docutils literal"><span class="pre">GLib.MarkupParseFlags</span></tt></a></li>
<li><strong>user_data</strong> (<a class="reference external" href="http://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></a>) &#8211; user data to pass to <a class="reference internal" href="MarkupParser.html#GLib.MarkupParser" title="GLib.MarkupParser"><tt class="xref py py-obj docutils literal"><span class="pre">GLib.MarkupParser</span></tt></a> functions</li>
<li><strong>user_data_dnotify</strong> (<a class="reference internal" href="../callbacks.html#GLib.DestroyNotify" title="GLib.DestroyNotify"><tt class="xref py py-class docutils literal"><span class="pre">GLib.DestroyNotify</span></tt></a>) &#8211; user data destroy notifier called when
the parse context is freed</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">a new <a class="reference internal" href="#GLib.MarkupParseContext" title="GLib.MarkupParseContext"><tt class="xref py py-obj docutils literal"><span class="pre">GLib.MarkupParseContext</span></tt></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#GLib.MarkupParseContext" title="GLib.MarkupParseContext"><tt class="xref py py-class docutils literal"><span class="pre">GLib.MarkupParseContext</span></tt></a></p>
</td>
</tr>
</tbody>
</table>
<p>Creates a new parse context. A parse context is used to parse
marked-up documents. You can feed any number of documents into
a context, as long as no errors occur; once an error occurs,
the parse context can&#8217;t continue to parse text (you have to
free it and create a new parse context).</p>
</dd></dl>

<dl class="method">
<dt id="GLib.MarkupParseContext.end_parse">
<tt class="descname">end_parse</tt><big>(</big><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><a class="reference internal" href="../classes/GError.html#GLib.GError" title="GLib.GError"><tt class="xref py py-class docutils literal"><span class="pre">GLib.GError</span></tt></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference external" href="http://docs.python.org/2.7/library/constants.html#True" title="(in Python v2.7)"><tt class="xref py py-obj docutils literal"><span class="pre">True</span></tt></a> on success, <a class="reference external" href="http://docs.python.org/2.7/library/constants.html#False" title="(in Python v2.7)"><tt class="xref py py-obj docutils literal"><span class="pre">False</span></tt></a> if an error was set</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><tt class="xref py py-obj docutils literal"><span class="pre">bool</span></tt></a></td>
</tr>
</tbody>
</table>
<p>Signals to the <a class="reference internal" href="#GLib.MarkupParseContext" title="GLib.MarkupParseContext"><tt class="xref py py-obj docutils literal"><span class="pre">GLib.MarkupParseContext</span></tt></a> that all data has been
fed into the parse context with <a class="reference internal" href="#GLib.MarkupParseContext.parse" title="GLib.MarkupParseContext.parse"><tt class="xref py py-obj docutils literal"><span class="pre">GLib.MarkupParseContext.parse</span></tt></a> ().</p>
<p>This function reports an error if the document isn&#8217;t complete,
for example if elements are still open.</p>
</dd></dl>

<dl class="method">
<dt id="GLib.MarkupParseContext.free">
<tt class="descname">free</tt><big>(</big><big>)</big></dt>
<dd><p>Frees a <a class="reference internal" href="#GLib.MarkupParseContext" title="GLib.MarkupParseContext"><tt class="xref py py-obj docutils literal"><span class="pre">GLib.MarkupParseContext</span></tt></a>.</p>
<p>This function can&#8217;t be called from inside one of the
<a class="reference internal" href="MarkupParser.html#GLib.MarkupParser" title="GLib.MarkupParser"><tt class="xref py py-obj docutils literal"><span class="pre">GLib.MarkupParser</span></tt></a> functions or while a subparser is pushed.</p>
</dd></dl>

<dl class="method">
<dt id="GLib.MarkupParseContext.get_element">
<tt class="descname">get_element</tt><big>(</big><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the name of the currently open element, or <a class="reference external" href="http://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><tt class="xref py py-obj docutils literal"><span class="pre">None</span></tt></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><tt class="xref py py-obj docutils literal"><span class="pre">str</span></tt></a></td>
</tr>
</tbody>
</table>
<p>Retrieves the name of the currently open element.</p>
<p>If called from the start_element or end_element handlers this will
give the element_name as passed to those functions. For the parent
elements, see <tt class="xref py py-obj docutils literal"><span class="pre">GLib.MarkupParseContext.get_element_stack</span></tt> ().</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.2.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="GLib.MarkupParseContext.get_position">
<tt class="descname">get_position</tt><big>(</big><em>line_number</em>, <em>char_number</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>line_number</strong> (<a class="reference external" href="http://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><tt class="xref py py-obj docutils literal"><span class="pre">int</span></tt></a> or <a class="reference external" href="http://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><tt class="xref py py-obj docutils literal"><span class="pre">None</span></tt></a>) &#8211; return location for a line number, or <a class="reference external" href="http://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><tt class="xref py py-obj docutils literal"><span class="pre">None</span></tt></a></li>
<li><strong>char_number</strong> (<a class="reference external" href="http://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><tt class="xref py py-obj docutils literal"><span class="pre">int</span></tt></a> or <a class="reference external" href="http://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><tt class="xref py py-obj docutils literal"><span class="pre">None</span></tt></a>) &#8211; return location for a <a class="reference external" href="http://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><tt class="xref py py-obj docutils literal"><span class="pre">str</span></tt></a>-on-line number, or <a class="reference external" href="http://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)"><tt class="xref py py-obj docutils literal"><span class="pre">None</span></tt></a></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Retrieves the current line number and the number of the character on
that line. Intended for use in error messages; there are no strict
semantics for what constitutes the &#8220;current&#8221; line number other than
&#8220;the best number we could come up with for error messages.&#8221;</p>
</dd></dl>

<dl class="method">
<dt id="GLib.MarkupParseContext.parse">
<tt class="descname">parse</tt><big>(</big><em>text</em>, <em>text_len</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>text</strong> (<a class="reference external" href="http://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><tt class="xref py py-obj docutils literal"><span class="pre">str</span></tt></a>) &#8211; chunk of text to parse</li>
<li><strong>text_len</strong> (<a class="reference external" href="http://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><tt class="xref py py-obj docutils literal"><span class="pre">int</span></tt></a>) &#8211; length of <cite>text</cite> in bytes</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><a class="reference internal" href="../classes/GError.html#GLib.GError" title="GLib.GError"><tt class="xref py py-class docutils literal"><span class="pre">GLib.GError</span></tt></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><a class="reference external" href="http://docs.python.org/2.7/library/constants.html#False" title="(in Python v2.7)"><tt class="xref py py-obj docutils literal"><span class="pre">False</span></tt></a> if an error occurred, <a class="reference external" href="http://docs.python.org/2.7/library/constants.html#True" title="(in Python v2.7)"><tt class="xref py py-obj docutils literal"><span class="pre">True</span></tt></a> on success</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="http://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><tt class="xref py py-obj docutils literal"><span class="pre">bool</span></tt></a></p>
</td>
</tr>
</tbody>
</table>
<p>Feed some data to the <a class="reference internal" href="#GLib.MarkupParseContext" title="GLib.MarkupParseContext"><tt class="xref py py-obj docutils literal"><span class="pre">GLib.MarkupParseContext</span></tt></a>.</p>
<p>The data need not be valid UTF-8; an error will be signaled if
it&#8217;s invalid. The data need not be an entire document; you can
feed a document into the parser incrementally, via multiple calls
to this function. Typically, as you receive data from a network
connection or file, you feed each received chunk of data into this
function, aborting the process if an error occurs. Once an error
is reported, no further data may be fed to the <a class="reference internal" href="#GLib.MarkupParseContext" title="GLib.MarkupParseContext"><tt class="xref py py-obj docutils literal"><span class="pre">GLib.MarkupParseContext</span></tt></a> ;
all errors are fatal.</p>
</dd></dl>

<dl class="method">
<dt id="GLib.MarkupParseContext.push">
<tt class="descname">push</tt><big>(</big><em>parser</em>, <em>user_data</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>parser</strong> (<a class="reference internal" href="MarkupParser.html#GLib.MarkupParser" title="GLib.MarkupParser"><tt class="xref py py-class docutils literal"><span class="pre">GLib.MarkupParser</span></tt></a>) &#8211; a <a class="reference internal" href="MarkupParser.html#GLib.MarkupParser" title="GLib.MarkupParser"><tt class="xref py py-obj docutils literal"><span class="pre">GLib.MarkupParser</span></tt></a></li>
<li><strong>user_data</strong> (<a class="reference external" href="http://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><tt class="xref py py-class docutils literal"><span class="pre">object</span></tt></a>) &#8211; user data to pass to <a class="reference internal" href="MarkupParser.html#GLib.MarkupParser" title="GLib.MarkupParser"><tt class="xref py py-obj docutils literal"><span class="pre">GLib.MarkupParser</span></tt></a> functions</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Temporarily redirects markup data to a sub-parser.</p>
<p>This function may only be called from the start_element handler of
a <a class="reference internal" href="MarkupParser.html#GLib.MarkupParser" title="GLib.MarkupParser"><tt class="xref py py-obj docutils literal"><span class="pre">GLib.MarkupParser</span></tt></a>. It must be matched with a corresponding call to
<tt class="xref py py-obj docutils literal"><span class="pre">GLib.MarkupParseContext.pop</span></tt> () in the matching end_element handler
(except in the case that the parser aborts due to an error).</p>
<p>All tags, text and other data between the matching tags is
redirected to the subparser given by <cite>parser</cite>. <cite>user_data</cite> is used
as the user_data for that parser. <cite>user_data</cite> is also passed to the
error callback in the event that an error occurs. This includes
errors that occur in subparsers of the subparser.</p>
<p>The end tag matching the start tag for which this call was made is
handled by the previous parser (which is given its own user_data)
which is why <tt class="xref py py-obj docutils literal"><span class="pre">GLib.MarkupParseContext.pop</span></tt> () is provided to allow &#8220;one
last access&#8221; to the <cite>user_data</cite> provided to this function. In the
case of error, the <cite>user_data</cite> provided here is passed directly to
the error callback of the subparser and <tt class="xref py py-obj docutils literal"><span class="pre">GLib.MarkupParseContext.pop</span></tt> ()
should not be called. In either case, if <cite>user_data</cite> was allocated
then it ought to be freed from both of these locations.</p>
<p>This function is not intended to be directly called by users
interested in invoking subparsers. Instead, it is intended to be
used by the subparsers themselves to implement a higher-level
interface.</p>
<p>As an example, see the following implementation of a simple
parser that counts the number of tags encountered.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="o">&lt;!--</span> <span class="n">language</span><span class="o">=</span><span class="s">&quot;C&quot;</span> <span class="o">--&gt;</span>
<span class="k">typedef</span> <span class="k">struct</span>
<span class="p">{</span>
  <span class="n">gint</span> <span class="n">tag_count</span><span class="p">;</span>
<span class="p">}</span> <span class="n">CounterData</span><span class="p">;</span>

<span class="k">static</span> <span class="kt">void</span>
<span class="nf">counter_start_element</span> <span class="p">(</span><span class="n">GMarkupParseContext</span>  <span class="o">*</span><span class="n">context</span><span class="p">,</span>
                       <span class="k">const</span> <span class="n">gchar</span>          <span class="o">*</span><span class="n">element_name</span><span class="p">,</span>
                       <span class="k">const</span> <span class="n">gchar</span>         <span class="o">**</span><span class="n">attribute_names</span><span class="p">,</span>
                       <span class="k">const</span> <span class="n">gchar</span>         <span class="o">**</span><span class="n">attribute_values</span><span class="p">,</span>
                       <span class="n">gpointer</span>              <span class="n">user_data</span><span class="p">,</span>
                       <span class="n">GError</span>              <span class="o">**</span><span class="n">error</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">CounterData</span> <span class="o">*</span><span class="n">data</span> <span class="o">=</span> <span class="n">user_data</span><span class="p">;</span>

  <span class="n">data</span><span class="o">-&gt;</span><span class="n">tag_count</span><span class="o">++</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span>
<span class="nf">counter_error</span> <span class="p">(</span><span class="n">GMarkupParseContext</span> <span class="o">*</span><span class="n">context</span><span class="p">,</span>
               <span class="n">GError</span>              <span class="o">*</span><span class="n">error</span><span class="p">,</span>
               <span class="n">gpointer</span>             <span class="n">user_data</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">CounterData</span> <span class="o">*</span><span class="n">data</span> <span class="o">=</span> <span class="n">user_data</span><span class="p">;</span>

  <span class="n">g_slice_free</span> <span class="p">(</span><span class="n">CounterData</span><span class="p">,</span> <span class="n">data</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="n">GMarkupParser</span> <span class="n">counter_subparser</span> <span class="o">=</span>
<span class="p">{</span>
  <span class="n">counter_start_element</span><span class="p">,</span>
  <span class="nb">NULL</span><span class="p">,</span>
  <span class="nb">NULL</span><span class="p">,</span>
  <span class="nb">NULL</span><span class="p">,</span>
  <span class="n">counter_error</span>
<span class="p">};</span>
</pre></div>
</div>
<p>In order to allow this parser to be easily used as a subparser, the
following interface is provided:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="o">&lt;!--</span> <span class="n">language</span><span class="o">=</span><span class="s">&quot;C&quot;</span> <span class="o">--&gt;</span>
<span class="kt">void</span>
<span class="n">start_counting</span> <span class="p">(</span><span class="n">GMarkupParseContext</span> <span class="o">*</span><span class="n">context</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">CounterData</span> <span class="o">*</span><span class="n">data</span> <span class="o">=</span> <span class="n">g_slice_new</span> <span class="p">(</span><span class="n">CounterData</span><span class="p">);</span>

  <span class="n">data</span><span class="o">-&gt;</span><span class="n">tag_count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">g_markup_parse_context_push</span> <span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">counter_subparser</span><span class="p">,</span> <span class="n">data</span><span class="p">);</span>
<span class="p">}</span>

<span class="n">gint</span>
<span class="n">end_counting</span> <span class="p">(</span><span class="n">GMarkupParseContext</span> <span class="o">*</span><span class="n">context</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">CounterData</span> <span class="o">*</span><span class="n">data</span> <span class="o">=</span> <span class="n">g_markup_parse_context_pop</span> <span class="p">(</span><span class="n">context</span><span class="p">);</span>
  <span class="kt">int</span> <span class="n">result</span><span class="p">;</span>

  <span class="n">result</span> <span class="o">=</span> <span class="n">data</span><span class="o">-&gt;</span><span class="n">tag_count</span><span class="p">;</span>
  <span class="n">g_slice_free</span> <span class="p">(</span><span class="n">CounterData</span><span class="p">,</span> <span class="n">data</span><span class="p">);</span>

  <span class="k">return</span> <span class="n">result</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The subparser would then be used as follows:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="o">&lt;!--</span> <span class="n">language</span><span class="o">=</span><span class="s">&quot;C&quot;</span> <span class="o">--&gt;</span>
<span class="k">static</span> <span class="kt">void</span> <span class="n">start_element</span> <span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">element_name</span><span class="p">,</span> <span class="p">...)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">strcmp</span> <span class="p">(</span><span class="n">element_name</span><span class="p">,</span> <span class="s">&quot;count-these&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">start_counting</span> <span class="p">(</span><span class="n">context</span><span class="p">);</span>

  <span class="c1">// else, handle other tags...</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="n">end_element</span> <span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">element_name</span><span class="p">,</span> <span class="p">...)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">strcmp</span> <span class="p">(</span><span class="n">element_name</span><span class="p">,</span> <span class="s">&quot;count-these&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">g_print</span> <span class="p">(</span><span class="s">&quot;Counted %d tags</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">end_counting</span> <span class="p">(</span><span class="n">context</span><span class="p">));</span>

  <span class="c1">// else, handle other tags...</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.18.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="GLib.MarkupParseContext.ref">
<tt class="descname">ref</tt><big>(</big><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the same <cite>context</cite></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="#GLib.MarkupParseContext" title="GLib.MarkupParseContext"><tt class="xref py py-class docutils literal"><span class="pre">GLib.MarkupParseContext</span></tt></a></td>
</tr>
</tbody>
</table>
<p>Increases the reference count of <cite>context</cite>.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.36.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="GLib.MarkupParseContext.unref">
<tt class="descname">unref</tt><big>(</big><big>)</big></dt>
<dd><p>Decreases the reference count of <cite>context</cite>.  When its reference count
drops to 0, it is freed.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.36.</span></p>
</div>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
          
        </div>
      </div>

    </section>

  </div> 

</body>

  

</html>